<html>
  <body>
    <script type="module">
      import { request } from "https://cdn.skypack.dev/@octokit/request";
      (async () => {
        const props = {
          owner: 'fenrir-naru',
          repo: 'archives',
          branch: 'main',
          filter: /^docs\//,
        }
        const req_sha = await request('GET /repos/{owner}/{repo}/git/ref/heads/{branch}', props);
        const sha = req_sha.data.object.sha
        const req = await request('GET /repos/{owner}/{repo}/git/trees/{tree_sha}',
            Object.assign(props, {tree_sha: sha, recursive: true}));
        let htmlString = '<ul>';
        for (let file of req.data.tree) {
          if(file.type != "blob"){continue;}
          if(!props.filter.test(file.path)){continue;}
          let fname = file.path.replace(props.filter, '');
          htmlString += `<li><a href="https://raw.githubusercontent.com/${props.owner}/${props.repo}/${sha}/${file.path}">${fname}</a></li>`;
        }
        htmlString += '</ul>';
        document.getElementsByTagName('body')[0].innerHTML = htmlString;
      })()
    </script>
  <body>
</html>
